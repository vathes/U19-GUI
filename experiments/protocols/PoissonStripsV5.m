function [mazes, criteria, globalSettings, vr] = PoissonStripsV5(vr)
  
  cueDur    = .1;     % in seconds

  %________________________________________ 1 _________ 2 _________ 3 _________ 4 _________ 5 _________ 6 _________ 7 _________ 8_________9_________10________ 11 ________ 12 ______________
  mazes     = struct( 'lStart'          , {6         , 30        , 30        , 30        , 30        , 30        , 30        , 30       , 30	    , 30       , 30         , 30         }   ...
                    , 'lCue'            , {40        , 120       , 160       , 240       , 370       , 370       , 370       , 340      , 330	    , 300      , 300        , 300        }   ...
                    , 'lMemory'         , {10        , 30        , 100       , 100       , 30        , 30        , 30        , 60       , 70	    , 100      , 100        , 100        }   ...
                    , 'lHint'           , {0         , 30        , 100       , 100       , 100       , 70        , 0         , 0        , 0       , 0        , 0          , 0          }   ...
                    , 'lTurn'           , {0         , 0         , 100       , 100       , 100       , 100       , 50        , 50       , 50 	    , 50       , 50         , 50         }   ...
                    , 'tri_turnHint'    , {true      , true      , true      , true      , true      , true      , true      , false    , false   , false    , false      , false      }   ...
                    , 'tri_hintOff'     , {true      , true      , true      , true      , true      , true      , true      , false    , false   , false    , false      , false      }   ...
                    , 'cueDuration'     , {inf       , cueDur*6  , cueDur*3  , cueDur*2  , cueDur    , cueDur    , cueDur    , cueDur   , cueDur  , cueDur   , cueDur     , cueDur     }   ... seconds
                    , 'cueProbability'  , {inf       , inf       , inf       , inf       , inf       , inf       , inf       , inf      , inf     , inf	     , 2.5        , 1.2        }   ...
                    , 'cueDensityPerM'  , {1         , 2         , 2         , 3         , 5         , 4         , 2.5       , 2.5      , 2.5     , 2.5 	   , 3          , 3.5        }   ...
                    );                                                                                                                                             
  criteria  = struct( 'numTrials'       , {20        , 80        , 100       , 100       , 100       , 100       , 100       , 100      , 100     , 100      , 100        , 100        }   ...
                    , 'numTrialsPerMin' , {3         , 3         , 3         , 3         , 3         , 3         , 3         , 3        , 3       , 3        , 3          , 3          }   ...
                    , 'warmupNTrials'   , {[]        , []        , []        , []        , []        , 40        , 40        , 40       , 40      , 40       , [10  ,15  ], [10  ,15  ]}   ...
                    , 'numSessions'     , {0         , 0         , 0         , 0         , 1         , 1         , 1         , 1        , 1 	    , 3        , 2          , 2          }   ...
                    , 'performance'     , {0         , 0         , 0.6       , 0.6       , 0.8       , 0.8       , 0.8       , 0.8      , 0.8     , 0.8      , 0.75       , 0.7        }   ...
                    , 'maxBias'         , {inf       , 0.2       , 0.2       , 0.2       , 0.1       , 0.1       , 0.1       , 0.1      , 0.1     , 0.1      , 0.15       , 0.15       }   ...
                    , 'warmupMaze'      , {[]        , []        , []        , []        , []        , 5         , 6         , 6        , 6       , 6        , [9   ,10  ], [9   ,11  ]}   ...
                    , 'warmupPerform'   , {[]        , []        , []        , []        , []        , 0.8       , 0.8       , 0.8      , 0.8     , 0.8      , [0.85,0.8 ], [0.85,0.8 ]}   ...
                    , 'warmupBias'      , {[]        , []        , []        , []        , []        , 0.1       , 0.1       , 0.1      , 0.1     , 0.1      , [0.1 ,0.1 ], [0.1 ,0.1 ]}   ...
                    , 'warmupMotor'     , {[]        , []        , []        , []        , []        , 0         , 0         , 0        , 0       , 0        , [0.75,0.75], [0.75,0.75]}   ...
                    );

  globalSettings          = {'cueMinSeparation', 16};
  vr.numMazesInProtocol   = numel(mazes);
  vr.stimulusGenerator    = @PoissonStimulusTrain;
  vr.stimulusParameters   = {'cueVisibleAt', 'cueDensityPerM', 'cueProbability', 'nCueSlots', 'cueMinSeparation', 'panSessionTrials'};
  vr.inheritedVariables   = {'cueDuration'};

  
  if nargout < 1
    figure; plot([mazes.lStart] + [mazes.lCue] + [mazes.lMemory], 'linewidth',1.5); xlabel('Shaping step'); ylabel('Maze length (cm)'); grid on;
    hold on; plot([mazes.lMemory], 'linewidth',1.5); legend({'total', 'memory'}, 'Location', 'east'); grid on;
    figure; plot([mazes.lMemory] ./ [mazes.lCue], 'linewidth',1.5); xlabel('Shaping step'); ylabel('L(memory) / L(cue)'); grid on;
    figure; plot([mazes.cueDensityPerM], 'linewidth',1.5); set(gca,'ylim',[0 6.5]); xlabel('Shaping step'); ylabel('Tower density (count/m)'); grid on;
    hold on; plot([mazes.cueDensityPerM] .* (1 - 1./(1 + exp([mazes.cueProbability]))), 'linewidth',1.5);
    hold on; plot([1 numel(mazes)], [1 1].*(100/globalSettings{2}), 'linewidth',1.5, 'linestyle','--');
    legend({'\rho_{L} + \rho_{R}', '\rho_{salient}', '(maximum)'}, 'location', 'southeast');
  end

end
