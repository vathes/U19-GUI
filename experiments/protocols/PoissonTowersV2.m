function [mazes, criteria, globalSettings, vr] = PoissonTowersV2(vr)
  
  %________________________________________ 1 _________ 2 _________ 3 _________ 4 _________ 5 _________ 6 _________ 7 __________ 8 __________ 9 __________ 10 _________ 11 _________ 12 ________ 13 _________ 14 _________ 15 ________ 16 _________ 17 ______________
  mazes     = struct( 'lStart'          , {6         , 30        , 30        , 30        , 30        , 30        , 30         , 30         , 30         , 30         , 30         , 30        , 30         , 30         , 30        , 30         , 30         }   ...
                    , 'lCue'            , {40        , 60        , 100       , 150       , 200       , 200       , 200        , 200        , 200        , 200        , 200        , 200       , 200        , 200        , 200       , 200        , 200        }   ...
                    , 'lMemory'         , {5         , 5         , 20        , 20        , 20        , 20        , 20         , 20         , 20         , 20         , 20         , 60        , 60         , 60         , 100       , 100        , 100        }   ...
                    , 'tri_turnHint'    , {true      , true      , true      , true      , true      , false     , false      , false      , false      , false      , false      , true      , false      , false      , true      , false      , false      }   ...
                    , 'cueVisibleRange' , {nan       , nan       , nan       , nan       , nan       , nan       , nan        , nan        , inf        , 6          , 6          , nan       , 6          , 6          , nan       , 6          , 6          }   ...
                    , 'cueProbability'  , {inf       , inf       , inf       , inf       , inf       , inf       , 2.5        , 1.2        , 1.2        , 1.2        , 0.5        , inf       , 2.5        , 1.2        , inf       , 2.5        , 1.2        }   ...
                    , 'cueDensityPerM'  , {4/0.4     , 4/0.6     , 5/1       , 7.5/1.5   , 10/2      , 10/2      , 10/2       , 10/2       , 10/2       , 10/2       , 10/2       , 10/2      , 10/2       , 10/2       , 10/2      , 10/2       , 10/2       }   ...
                    );                                                                                                                                                                                                                                        
  criteria  = struct( 'numTrials'       , {80        , 80        , 100       , 100       , 100       , 100       , 100        , 100        , 100        , 100        , 100        , 100       , 100        , 100        , 100       , 100        , 100        }   ...
                    , 'numTrialsPerMin' , {0         , 0         , 0         , 0         , 3         , 3         , 3          , 3          , 3          , 3          , 3          , 3         , 3          , 3          , 3         , 3          , 3          }   ...
                    , 'warmupNTrials'   , {[]        , []        , []        , []        , []        , 40        , [10  ,15  ], [10  ,15  ], [10  ,15  ], [10  ,15  ], [10  ,15  ], []        , [10  ,15  ], [10  ,15  ], []        , [10  ,15  ], [10  ,15  ]}   ...
                    , 'numSessions'     , {0         , 0         , 0         , 0         , 2         , 3         , 2          , 2          , 1          , 1          , 2          , 2         , 2          , 1          , 2         , 2          , 1          }   ...
                    , 'performance'     , {0         , 0         , 0.6       , 0.6       , 0.8       , 0.75      , 0.75       , 0.7        , 0.7        , 0.65       , 0.6        , 0.8       , 0.75       , 0.65       , 0.8       , 0.75       , 0.65       }   ...
                    , 'maxBias'         , {inf       , 0.2       , 0.2       , 0.2       , 0.15      , 0.15      , 0.15       , 0.15       , 0.15       , 0.15       , 0.2        , 0.15      , 0.15       , 0.15       , 0.15      , 0.15       , 0.15       }   ...
                    , 'warmupMaze'      , {[]        , []        , []        , []        , []        , 5         , [5   ,6   ], [5   ,7   ], [5   ,7   ], [5   ,7   ], [5   ,7   ], []        , [5   ,6   ], [12  ,13  ], []        , [5   ,6   ], [15  ,16  ]}   ...
                    , 'warmupPerform'   , {[]        , []        , []        , []        , []        , 0.8       , [0.85,0.8 ], [0.85,0.75], [0.85,0.75], [0.85,0.75], [0.85,0.75], []        , [0.85,0.8 ], [0.85,0.75], []        , [0.85,0.8 ], [0.85,0.75]}   ...
                    , 'warmupBias'      , {[]        , []        , []        , []        , []        , 0.2       , [0.1 ,0.15], [0.1 ,0.15], [0.1 ,0.15], [0.1 ,0.15], [0.1 ,0.15], []        , [0.1 ,0.15], [0.1 ,0.15], []        , [0.1 ,0.15], [0.1 ,0.15]}   ...
                    , 'warmupMotor'     , {[]        , []        , []        , []        , []        , 0         , [0.75,0.75], [0.75,0.75], [0.75,0.75], [0.75,0.75], [0.75,0.75], []        , [0.75,0.75], [0.75,0.75], []        , [0.75,0.75], [0.75,0.75]}   ...
                    , 'demoteNumBlocks' , {[]        , []        , []        , []        , []        , []        , []         , 3          , 3          , 3          , 3          , []        , []         , 3          , []        , []         , 3          }   ...
                    , 'demoteBlockSize' , {[]        , []        , []        , []        , []        , []        , []         , 40         , 40         , 40         , 40         , []        , []         , 40         , []        , []         , 40         }   ...
                    , 'demotePerform'   , {nan       , nan       , nan       , nan       , nan       , nan       , nan        , 0.2        , 0.2        , 0.2        , 0.2        , nan       , nan        , 0.2        , nan       , nan        , 0.2        }   ...
                    , 'demoteBias'      , {nan       , nan       , nan       , nan       , nan       , nan       , nan        , 0.8        , 0.8        , 0.8        , 0.8        , nan       , nan        , 0.8        , nan       , nan        , 0.8        }   ...
                    );

  globalSettings          = {'cueVisibleAt', 10};
  vr.numMazesInProtocol   = 10;
  vr.stimulusGenerator    = @PoissonStimulusTrain;
  vr.stimulusParameters   = {'cueVisibleAt', 'cueDensityPerM', 'cueProbability', 'nCueSlots', 'cueMinSeparation'};
  vr.inheritedVariables   = {'cueVisibleRange'};

  
  if nargout < 1
    figure; plot([mazes.lStart] + [mazes.lCue] + [mazes.lMemory], 'linewidth',1.5); xlabel('Shaping step'); ylabel('Maze length (cm)'); grid on;
    hold on; plot([mazes.lMemory], 'linewidth',1.5); legend({'total', 'memory/delay'}, 'Location', 'east'); grid on;
    figure; plot([mazes.lMemory] ./ [mazes.lCue], 'linewidth',1.5); xlabel('Shaping step'); ylabel('L(memory) / L(cue)'); grid on;
    figure; plot([mazes.cueDensityPerM], 'linewidth',1.5); set(gca,'ylim',[1 5.5]); xlabel('Shaping step'); ylabel('Tower density (count/m)'); grid on;
  end
  
end
